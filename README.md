# Self Driving Vehicles Using Deep Reinforcement Learning

** Description **

This is the project of my thesis. I've implemented an agent in CARLA Simulator, which is capable of navigating a vehicle safe & fast, using only 2 front cameras. More info about the simulator can be found here: https://carla.org/ . The agent has learnt to navigate in a lane using deep reinforcement learning algorithms. The development of the agent was made in Python.

![slide1](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B11.PNG)
---
![slide2](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B12.PNG)
---
![slide3](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B13.PNG)
---
![slide4](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B14.PNG)
---
![slide5](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B15.PNG)
---
![slide6](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B16.PNG)
---
![slide7](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B17.PNG)
---
![slide8](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B18.PNG)
---
![slide9](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B19.PNG)
---
![slide10](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B110.PNG)
---
![slide11](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B111.PNG)
---
![slide12](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B112.PNG)
---
![slide13](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B113.PNG)
---
![slide14](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B114.PNG)
---
![slide15](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B115.PNG)
---
![slide16](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B116.PNG)
---
![slide17](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B117.PNG)
---
![slide18](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B118.PNG)
---
![slide19](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B119.PNG)
---
![slide20](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B120.PNG)
---
![slide21](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B121.PNG)
---
![slide22](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B122.PNG)
---
![slide23](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B123.PNG)
---
![slide24](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B124.PNG)
---
![slide25](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B125.PNG)
---
![slide26](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B126.PNG)
---
![slide27](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B127.PNG)
---
![slide28](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B128.PNG)
---
![slide29](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B129.PNG)
---
![slide30](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B130.PNG)
---
![slide31](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B131.PNG)
---
![slide32](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B132.PNG)
---
![slide33](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B133.PNG)
---
![slide34](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B134.PNG)
---
![slide35](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B135.PNG)
---
![slide36](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B136.PNG)
---
![slide37](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B137.PNG)
---
![slide38](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B138.PNG)
---
![slide39](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B139.PNG)
---
![slide40](https://github.com/kochlisGit/autonomous-vehicles-agent/blob/main/images/%CE%94%CE%B9%CE%B1%CF%86%CE%AC%CE%BD%CE%B5%CE%B9%CE%B140.PNG)
---

# Demonstration #

This directory contains 8 video files (mp4) that demonstrate how the vehicle is moving in the simulator
https://github.com/kochlisGit/autonomous-vehicles-agent/tree/main/videos

The validation of the vehicle was done in a pre-defined route, that was new to the agent. The results are astonishing!

# Python Libraries #

1. Carla API
2. Numpy
3. Matplotlib
4. Tensorflow
5. Keras
6. TF-Agents
7. Tensorflow-Addons

# Sensors

1. Collision Detector: https://carla.readthedocs.io/en/latest/ref_sensors/#collision-detector
2. RGB Camera with Semantic Segmentation: https://carla.readthedocs.io/en/latest/ref_sensors/#semantic-segmentation-camera
3. Depth Camera: https://carla.readthedocs.io/en/latest/ref_sensors/#depth-camera

# Algorithms:

* DQN: https://www.cs.toronto.edu/~vmnih/docs/dqn.pdf
* N-Step DQN: https://arxiv.org/pdf/1901.07510.pdf
* DDQN: https://arxiv.org/pdf/1509.06461.pdf
* C51: https://arxiv.org/pdf/1707.06887.pdf
* Decaying Epsilon Greedy: http://tokic.com/www/tokicm/publikationen/papers/AdaptiveEpsilonGreedyExploration.pdf
* Convolutional Neural Network CNN: https://iopscience.iop.org/article/10.1088/1742-6596/1004/1/012028/pdf
* Yogi Optimizer: https://papers.nips.cc/paper/2018/file/90365351ccc7437a1309dc64e4db32a3-Paper.pdf
* GELU: https://arxiv.org/pdf/1606.08415.pdf

# Execution

First, You have to download carla and all the libraries above. Then, download my "code" directory and paste it into "Carla/PythonAPI/". Run "agent/straight_lane_agent_c51_training.py" to start the training.

**IMPORTANT** The simulator window should be open, in order for the training to occur. Check https://carla.readthedocs.io/en/latest/start_introduction/ for more information of how to setup carla.
